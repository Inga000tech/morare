<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morare — Daily Ritual</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400;1,600&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        /* Base Design System */
        :root {
            --paper: #fcfaf8;
            --ink: #2d2d2d;
            --gold: #c5a059;
            --faint: rgba(0,0,0,0.05);
        }
        body { background-color: var(--paper); color: var(--ink); font-family: 'Inter', sans-serif; }
        .serif { font-family: 'Cormorant Garamond', serif; }
        
        /* Smooth Scroll & Animations */
        html { scroll-behavior: smooth; }
        .fade-in { opacity: 0; transform: translateY(30px); transition: all 0.8s ease-out; }
        .fade-in.visible { opacity: 1; transform: translateY(0); }

        /* UI Elements */
        .glass-panel {
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(12px);
            border-left: 1px solid rgba(0,0,0,0.05);
        }
        .section-label {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: #999;
            font-weight: 600;
            display: block;
            margin-bottom: 1rem;
        }

        /* Side Menu Transition */
        #side-menu { transform: translateX(100%); transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        #side-menu.open { transform: translateX(0); }
        
        /* Tabs styling */
        .tab-btn.active { color: black; border-bottom: 2px solid black; }
        .tab-btn { color: #999; border-bottom: 2px solid transparent; }
    </style>
</head>
<body>

    <nav class="fixed top-0 left-0 w-full z-40 bg-[rgba(252,250,248,0.9)] backdrop-blur-md border-b border-[rgba(0,0,0,0.03)]">
        <div class="max-w-screen-md mx-auto flex justify-between items-center px-6 py-4">
            <div class="text-2xl serif font-semibold italic tracking-tight">Morare</div>
            
            <button onclick="toggleMenu()" class="group flex items-center gap-3 px-4 py-2 hover:bg-black hover:text-white rounded-full transition-all">
                <span class="text-[10px] font-bold uppercase tracking-widest hidden sm:block">Menu</span>
                <div class="space-y-1">
                    <span class="block w-5 h-px bg-current"></span>
                    <span class="block w-5 h-px bg-current"></span>
                </div>
            </button>
        </div>
    </nav>

    <div id="overlay" onclick="toggleMenu()" class="fixed inset-0 bg-black/20 backdrop-blur-sm z-40 hidden opacity-0 transition-opacity duration-300"></div>
    
    <aside id="side-menu" class="fixed top-0 right-0 h-full w-full sm:w-[400px] bg-white z-50 shadow-2xl flex flex-col">
        <div class="p-8 pb-0 flex justify-between items-center">
            <h2 class="serif text-3xl italic">Dashboard</h2>
            <button onclick="toggleMenu()" class="p-2 hover:rotate-90 transition duration-300">✕</button>
        </div>

        <div id="auth-section" class="px-8 mt-6">
            <div id="view-guest" class="bg-gray-50 p-6 rounded-xl">
                <p class="text-sm text-gray-500 mb-4">Sync your journey.</p>
                <input type="text" id="input-name" placeholder="Your Name" class="w-full bg-white border border-gray-200 p-3 rounded-lg text-sm mb-3 outline-none focus:border-black">
                <button onclick="signIn()" class="w-full bg-black text-white py-3 rounded-lg text-sm font-bold">Create Account</button>
            </div>
            
            <div id="view-user" class="hidden flex items-center gap-4 bg-orange-50/50 p-4 rounded-xl border border-orange-100">
                <div class="h-10 w-10 bg-orange-200 rounded-full flex items-center justify-center font-serif text-orange-900" id="user-avatar">?</div>
                <div>
                    <p class="font-bold text-sm" id="user-name">Guest</p>
                    <p class="text-xs text-orange-800/60">Free Tier Member</p>
                </div>
            </div>
        </div>

        <div class="flex px-8 mt-8 border-b border-gray-100 gap-6">
            <button onclick="switchTab('reflections')" id="tab-reflections" class="tab-btn active pb-3 text-sm font-medium transition">Reflections</button>
            <button onclick="switchTab('settings')" id="tab-settings" class="tab-btn pb-3 text-sm font-medium transition">Settings</button>
        </div>

        <div class="flex-1 overflow-y-auto p-8 bg-gray-50/30">
            
            <div id="content-reflections">
                <div id="archive-list" class="space-y-3">
                    <p class="text-xs text-gray-400 italic text-center mt-10">No entries found yet.</p>
                </div>
            </div>

            <div id="content-settings" class="hidden space-y-6">
                <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600">Dark Mode</span>
                    <button class="w-10 h-5 bg-gray-200 rounded-full relative"><span class="absolute left-1 top-1 w-3 h-3 bg-white rounded-full"></span></button>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600">Daily Reminder</span>
                    <span class="text-xs text-gray-400">7:00 AM</span>
                </div>
                <hr class="border-gray-200">
                <button onclick="signOut()" class="text-red-500 text-sm font-medium hover:underline">Sign Out</button>
            </div>
        </div>
    </aside>

    <main class="max-w-screen-sm mx-auto px-6 pb-40">

        <header class="h-[90vh] flex flex-col justify-center items-center text-center fade-in">
            <span class="section-label text-orange-800">February 7, 2026</span>
            <h1 class="text-6xl sm:text-8xl mb-2 serif">Kintsugi</h1>
            <p class="text-lg text-gray-400 font-light mb-8">(Noun) Golden Joinery</p>
            <p class="serif italic text-2xl text-gray-600 max-w-md leading-relaxed">
                The Japanese art of repairing broken pottery by mending the areas of breakage with lacquer dusted or mixed with powdered gold.
            </p>
            <div class="mt-20 animate-bounce text-gray-300">↓</div>
        </header>

        <section class="py-24 border-t border-gray-100 fade-in">
            <span class="section-label">The History</span>
            <h2 class="text-3xl serif mb-6">The Shogun's Bowl</h2>
            <div class="prose prose-lg text-gray-600 leading-8 font-light">
                <p>
                    In the late 15th century, the Japanese Shogun Ashikaga Yoshimitsu sent a damaged Chinese tea bowl back to China for repairs. It returned held together with ugly metal staples. 
                </p>
                <p class="mt-4">
                    Disappointed, he asked his own craftsmen to find a more aesthetic method of repair. They decided that instead of hiding the damage, they would illuminate it. This birthed a philosophy: the break is not the end of the object’s life, but a moment in its history that makes it more beautiful.
                </p>
            </div>
        </section>

        <section class="py-24 border-t border-gray-100 fade-in bg-white -mx-6 px-6">
            <span class="section-label text-center">The Perspective</span>
            <blockquote class="text-4xl sm:text-5xl serif italic text-center mt-10 leading-tight text-gray-800">
                "The world breaks everyone and afterward many are strong at the broken places."
            </blockquote>
            <p class="text-center mt-8 text-sm font-bold uppercase tracking-widest text-gray-400">— Ernest Hemingway</p>
        </section>

        <section class="py-24 fade-in">
            <span class="section-label">The Metaphor</span>
            <h2 class="text-3xl serif mb-6">Gold in the Cracks</h2>
            <p class="text-xl leading-relaxed text-gray-600 font-light">
                We spend so much of our lives trying to present a seamless front. We hide our grief, our failures, and our rejections. But <span class="serif italic text-black">Morare</span> asks: what if you highlighted them? What if the "ruined" part of your year was actually the entry point for the gold?
            </p>
        </section>

        <section class="py-20 my-10 bg-gray-100 rounded-3xl text-center fade-in">
            <span class="section-label mb-6">Grounding</span>
            <p class="serif text-2xl text-gray-500 italic">Take one deep breath.</p>
            <div class="w-1 h-16 bg-gray-300 mx-auto my-6"></div>
            <p class="text-sm text-gray-500">Release the tension in your jaw.</p>
        </section>

        <section class="py-10 fade-in" id="journal-section">
            <div class="bg-white p-8 sm:p-12 rounded-[2rem] shadow-xl shadow-gray-100 border border-gray-100">
                <span class="section-label text-center text-orange-800">The Ritual</span>
                
                <h3 class="text-3xl sm:text-4xl serif text-center mb-10 mt-4">
                    What is a "crack" in your life right now that you could treat with gold?
                </h3>
                
                <div class="relative group">
                    <textarea id="journalEntry" class="w-full h-80 p-6 bg-[url('https://www.transparenttextures.com/patterns/lined-paper.png')] bg-white border border-gray-200 rounded-lg text-lg leading-loose serif focus:outline-none focus:border-orange-300 transition resize-none" placeholder="Start writing here..."></textarea>
                    <div class="absolute bottom-4 right-4 text-xs text-gray-300 pointer-events-none">Auto-saving...</div>
                </div>

                <div class="flex flex-col sm:flex-row justify-between items-center mt-8 gap-4">
                    <button onclick="exportPDF()" class="text-gray-400 hover:text-black text-xs uppercase font-bold tracking-widest transition">
                        ↓ Download PDF
                    </button>
                    <button onclick="saveEntry()" class="bg-black text-white px-12 py-4 rounded-full text-sm font-bold tracking-wide hover:scale-105 active:scale-95 transition shadow-lg">
                        Save Entry
                    </button>
                </div>
                <p id="save-feedback" class="text-center text-xs text-green-600 mt-4 h-4 opacity-0 transition">Saved to Reflections</p>
            </div>
        </section>

    </main>

    <footer class="text-center py-10 text-gray-300 text-xs uppercase tracking-widest">
        Morare © 2026
    </footer>

    <div id="pdf-template" style="display:none">
        <div style="padding: 60px; font-family: 'Times New Roman', serif;">
            <div style="text-align:center; border-bottom: 1px solid #ddd; padding-bottom: 20px; margin-bottom: 40px;">
                <h1 style="font-size: 40px; margin:0;">Kintsugi</h1>
                <p style="color:#666; font-style:italic;">February 7, 2026</p>
            </div>
            <p style="font-weight:bold; margin-bottom: 20px;">Prompt: Where is the gold in your cracks?</p>
            <div id="pdf-body" style="font-size: 14px; line-height: 2;"></div>
        </div>
    </div>

    <script>
        // --- 1. UI & Animations ---
        function toggleMenu() {
            const menu = document.getElementById('side-menu');
            const overlay = document.getElementById('overlay');
            const isOpen = menu.classList.contains('open');
            
            if (isOpen) {
                menu.classList.remove('open');
                overlay.classList.remove('active');
                setTimeout(() => overlay.classList.add('hidden'), 300);
            } else {
                overlay.classList.remove('hidden');
                // tiny delay to allow display:block to apply before opacity transition
                setTimeout(() => overlay.classList.add('active'), 10); 
                menu.classList.add('open');
            }
        }

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if(entry.isIntersecting) entry.target.classList.add('visible');
            });
        }, { threshold: 0.1 });
        document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

        // --- 2. Tab Switching logic ---
        function switchTab(tabName) {
            // Update Buttons
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`tab-${tabName}`).classList.add('active');
            
            // Update Content
            document.getElementById('content-reflections').classList.add('hidden');
            document.getElementById('content-settings').classList.add('hidden');
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
        }

        // --- 3. Auth Logic (Local Storage Simulation) ---
        function signIn() {
            const name = document.getElementById('input-name').value;
            if(!name) return alert("Please enter a name.");
            
            const user = { name: name, joined: new Date().toLocaleDateString() };
            localStorage.setItem('morare_user', JSON.stringify(user));
            checkAuth();
        }

        function signOut() {
            if(confirm("Are you sure? This will remove your profile name from this device.")) {
                localStorage.removeItem('morare_user');
                location.reload();
            }
        }

        function checkAuth() {
            const user = JSON.parse(localStorage.getItem('morare_user'));
            if(user) {
                document.getElementById('view-guest').classList.add('hidden');
                document.getElementById('view-user').classList.remove('hidden');
                document.getElementById('view-user').classList.add('flex');
                document.getElementById('user-name').innerText = user.name;
                document.getElementById('user-avatar').innerText = user.name.charAt(0).toUpperCase();
            } else {
                document.getElementById('view-guest').classList.remove('hidden');
                document.getElementById('view-user').classList.add('hidden');
                document.getElementById('view-user').classList.remove('flex');
            }
        }

        // --- 4. Journaling & Archive Logic ---
        const ENTRY_KEY = 'morare_entry_2026-02-07';

        function saveEntry() {
            const text = document.getElementById('journalEntry').value;
            if(!text) return;

            // Save to local storage
            localStorage.setItem(ENTRY_KEY, text);
            
            // Visual Feedback
            const feedback = document.getElementById('save-feedback');
            feedback.style.opacity = '1';
            setTimeout(() => feedback.style.opacity = '0', 3000);

            // Update Archive List immediately
            loadReflections();
        }

        function loadReflections() {
            const list = document.getElementById('archive-list');
            list.innerHTML = ''; // Clear current list
            
            // Look for our specific entry (In a real app, we'd loop through all keys)
            const todayEntry = localStorage.getItem(ENTRY_KEY);
            
            if(todayEntry) {
                const item = document.createElement('div');
                item.className = 'p-4 bg-white rounded-lg border border-gray-100 cursor-pointer hover:shadow-md transition';
                item.onclick = () => {
                    toggleMenu();
                    document.getElementById('journal-section').scrollIntoView();
                };
                item.innerHTML = `
                    <div class="flex justify-between items-center mb-1">
                        <span class="text-[10px] uppercase font-bold text-orange-800">Feb 7</span>
                        <span class="text-[10px] text-gray-400">Kintsugi</span>
                    </div>
                    <p class="text-xs text-gray-600 truncate font-serif italic">${todayEntry}</p>
                `;
                list.appendChild(item);
            } else {
                 list.innerHTML = '<p class="text-xs text-gray-400 italic text-center mt-10">Your journal is empty.</p>';
            }
        }

        // --- 5. PDF Export ---
        function exportPDF() {
            const text = document.getElementById('journalEntry').value;
            if(!text) return alert("Please write something first.");
            
            document.getElementById('pdf-body').innerText = text;
            const element = document.getElementById('pdf-template');
            element.style.display = 'block';
            
            const opt = {
                margin: 1,
                filename: 'Morare_Kintsugi.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
            };

            html2pdf().set(opt).from(element).save().then(() => {
                element.style.display = 'none';
            });
        }

        // --- Initialization ---
        window.onload = () => {
            checkAuth();
            
            // Load saved text if exists
            const savedText = localStorage.getItem(ENTRY_KEY);
            if(savedText) {
                document.getElementById('journalEntry').value = savedText;
            }
            
            loadReflections();
        };
    </script>
</body>
</html>
